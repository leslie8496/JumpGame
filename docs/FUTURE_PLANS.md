# 🗺️ 项目未来计划与已知问题 (Future Plans & Known Issues)

本文档记录了项目当前存在的待解决问题 (Bug) 和后续的功能开发计划。

---

## 🐞 已知问题 (Known Issues)

### 问题描述：移动平台→墙面→无法扒墙

**具体现象：**

当玩家角色先跳到 **可移动平台** (Moving Platform) 上，然后尝试跳到 **墙体** 上时，角色无法执行正常的 **扒墙 (Wall Sliding)** 或 **贴墙** 动作。角色会直接掉落，或产生不稳定的物理行为。

#### 根本原因分析 (Root Cause Analysis)

这个问题几乎总是由 **父子关系 (Parenting)** 和 **物理速度的继承** 导致的。

| 可能原因 | 详细解释 |
| :--- | :--- |
| **速度继承问题** | 当角色站在移动平台上时，脚本可能会将角色的 `Rigidbody` 设置为平台的子对象 (Parenting)。离开平台时，如果 **没有及时解除父子关系**，角色的速度或位置可能会继续受到平台速度的影响，导致其速度与墙面检测方向冲突。 |
| **地/墙检测冲突** | 角色离开移动平台后，可能需要一个短暂的 **缓冲期** 来重置其速度和 `isGround` 状态。如果在缓冲期内碰到墙体，`isGround` (或 `isWalling`) 的判断可能因为继承的速度而混乱。|
| **`Rigidbody.velocity` 干扰** | 如果角色离开平台后，继承的平台速度仍然存在于 `rb.velocity` 的某一轴上，这部分残留速度可能会干扰墙体检测或贴墙时的摩擦力计算。 |

#### 解决思路 (Proposed Solution)

1.  **统一父子关系解除 (Unparenting)：**
    * 在 `PlayerMove` 或 `PlayerJump` 脚本中，添加一个严格的函数 (`UnparentPlayer()`)，确保在 **所有跳跃** (包括从墙上跳、普通跳) 和 **离开移动平台** 时，角色的 `transform.parent` 属性被设置为 `null`。
2.  **物理速度清零/重置：**
    * 在离开移动平台或执行墙跳时，对 `rb.velocity` 进行有选择性的重置（例如，将水平速度 `x` 保持，但垂直速度 `y` 重置），以消除残余的平台速度干扰。
3.  **增加检测延迟：**
    * 墙面检测逻辑 (`WallCheck`) 中，加入一个极小的 **延迟/冷却时间** (e.g., 0.1s)，以确保角色在离开移动平台的瞬间，不会立即触发错误的墙面检测逻辑。

---

## 🚀 未来计划 (Future Plans)

| 模块 | 功能/优化目标 | 预期影响 |
| :--- | :--- | :--- |
| **核心机制** | **悬崖自动返回出生点 (Respawn)** | 提高玩家体验，避免玩家因掉落到无法到达的区域而卡死。 |
| **关卡设计** | **扩展关卡宽度** | 增加地图探索性，设计更复杂的平台跳跃路线。 |
| **关卡设计** | **制作可移动的陷阱** | 增加游戏难度和动态元素，例如来回移动的尖刺或火焰。 |
| **代码优化** | **物理代码迁移至 FixedUpdate** | 将所有 `Rigidbody` 操作从 `Update()` 迁移到 `FixedUpdate()`，确保物理计算的稳定性和一致性。|